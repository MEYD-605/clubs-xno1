---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';
import Navbar from '../../components/navbar';
import Footer from '../../components/footer';
import FloatingButtons from '../../components/floating-buttons';
import SEO from '../../components/seo.astro';
import '../../styles/globals.css';

export async function getStaticPaths() {
	const blogEntries = await getCollection('blog');
	return blogEntries.map(entry => ({
		params: { slug: entry.slug }, props: { entry },
	}));
}

export const prerender = true;

const { entry } = Astro.props;
const { Content } = await entry.render();
---

<BaseLayout>
	<SEO 
		title={entry.data.title + " | Soul-Brews Studio"}
		description={entry.data.description}
		image={entry.data.heroImage}
		articleDate={entry.data.pubDate}
	/>
	
	<Navbar client:load />

	<main class="min-h-screen pt-32 pb-20">
		<article class="container mx-auto px-4 max-w-4xl">
			<!-- Header -->
			<header class="mb-12 text-center">
				<div class="inline-block px-4 py-1 rounded-full text-xs font-mono mb-4" style="background: rgba(255,107,53,0.1); color: #FF6B35;">
					{entry.data.pubDate.toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric' })}
				</div>
				<h1 class="text-display-md md:text-display-lg mb-6 leading-tight">
					{entry.data.title}
				</h1>
				<p class="text-body-lg text-white/60 max-w-2xl mx-auto">
					{entry.data.description}
				</p>
			</header>

			<!-- Hero Image -->
			{entry.data.heroImage && (
				<div class="aspect-video rounded-3xl overflow-hidden mb-16 border border-white/10 shadow-2xl">
					<img src={entry.data.heroImage} alt={entry.data.title} class="w-full h-full object-cover" />
				</div>
			)}

			<!-- Content Area -->
			<div class="glass-card p-8 md:p-12 prose prose-invert prose-orange max-w-none">
				<Content />
			</div>

			<!-- Footer Meta -->
			<footer class="mt-12 pt-8 border-t border-white/10 flex flex-wrap gap-4 items-center justify-between">
				<div class="flex flex-wrap gap-2">
					{entry.data.tags.map(tag => (
						<span class="px-3 py-1 rounded-full bg-white/5 border border-white/10 text-xs text-white/50">
							#{tag}
						</span>
					))}
				</div>
				<div class="text-sm text-white/40">
					Written by {entry.data.author}
				</div>
			</footer>

			<!-- Back to Blog (Optional for now) -->
			<div class="mt-12 text-center">
				<a href="/services" class="btn-secondary">
					‚Üê Back to Services
				</a>
			</div>
		</article>
	</main>

	<Footer client:load />
	<FloatingButtons client:load />
</BaseLayout>

<style is:global>
	@reference "../../styles/globals.css";

	/* Custom styling for the blog content using standard Tailwind typography */
	.prose h2 { @apply text-2xl md:text-3xl font-light tracking-tight mt-12 mb-6 text-white; }
	.prose h3 { @apply text-xl md:text-2xl font-bold mt-8 mb-4 text-white; }
	.prose p { @apply text-base text-white/70 mb-6 leading-relaxed; }
	.prose ul { @apply list-disc list-inside mb-6 space-y-2 text-white/80; }
	.prose blockquote { @apply border-l-4 border-orange-400 pl-6 italic text-lg py-4 my-8 bg-orange-400/5 rounded-r-2xl text-white/90; }
</style>
